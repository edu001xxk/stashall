name: Cloudflare è‡ªåŠ¨ä¼˜é€‰ (å†…åµŒç‰ˆ)
desc: è„šæœ¬ç›´æ¥å†…ç½®ï¼Œè§£å†³ä¸‹è½½å¤±è´¥é—®é¢˜

# ==================================
# 1. é¦–é¡µç£è´´ (UI)
# ==================================
tiles:
  - name: CF-Best-IP
    title: Cloudflare ä¼˜é€‰
    content: ç‚¹å‡»è¿è¡Œæµ‹é€Ÿ
    icon: network
    collapsed: false

# è¿™é‡Œçš„ cf.js ä¾ç„¶ä¿ç•™è¿œç¨‹ï¼Œå› ä¸ºå®ƒæ˜¯UIäº¤äº’ï¼Œä¸åƒèŠ‚ç‚¹ç”Ÿæˆé‚£ä¹ˆæ•æ„Ÿ
script-providers:
  CF-Best-IP:
    url: "https://raw.githubusercontent.com/edu001xxk/stashall/refs/heads/main/cf.js?v=ui_final"
    interval: 0

# ==================================
# 2. èŠ‚ç‚¹ç”Ÿæˆ (æ ¸å¿ƒä¿®æ”¹ï¼šç›´æ¥å†…åµŒä»£ç )
# ==================================
proxy-providers:
  "CF-Provider":
    type: script
    interval: 300
    health-check:
      enable: true
      url: http://www.gstatic.com/generate_204
      interval: 300
    # âš ï¸ å…³é”®ç‚¹ï¼šè¿™é‡Œä¸å¡« urlï¼Œç›´æ¥å¡« content
    # Stash ä¼šç›´æ¥è¿è¡Œè¿™æ®µä»£ç ï¼Œæ— éœ€è”ç½‘ä¸‹è½½ js
    content: |
      // 1. å°è¯•è¯»å–ä¼˜é€‰ IP
      var savedIP = $persistentStore.read("CF_BEST_IP");
      var address = "cf.zhetengsha.eu.org"; // é»˜è®¤ä¿åº•

      // ç®€å•çš„æ ¼å¼æ ¡éªŒ
      if (savedIP && savedIP.length > 5 && savedIP.indexOf(".") > -1) {
          address = savedIP;
      }

      // 2. è¾“å‡ºèŠ‚ç‚¹ (ä½¿ç”¨ä½ æä¾›çš„ VLESS æ ¼å¼)
      $done({
        proxies: [{
          "name": "ğŸš€ è‡ªåŠ¨ä¼˜é€‰ | " + address,
          "type": "vless",
          "server": address,
          "port": 443,
          "uuid": "87d1bfd4-574e-4c96-ad42-0426f27461ff",
          "tls": true,
          "skip-cert-verify": true,
          "network": "ws",
          "servername": "_acme-challenge.2go.cloudns.be",
          "ws-opts": {
            "path": "/?ed",
            "headers": { "Host": "_acme-challenge.2go.cloudns.be" }
          },
          "udp": true
        }]
      });

# ==================================
# 3. ç­–ç•¥ç»„ (è®©å®ƒæ˜¾ç¤ºåœ¨åˆ—è¡¨é‡Œ)
# ==================================
proxy-groups:
  - name: "ğŸš€ è‡ªåŠ¨ä¼˜é€‰"
    type: select
    use:
      - "CF-Provider"
